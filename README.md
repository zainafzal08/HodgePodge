1. refactors
2. add hodge code tests for env. variables
3. last_roll is server wide not channel wide
